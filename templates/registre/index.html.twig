{% extends 'base.html.twig' %}

{% block title %}Registre de Sécurité
{% endblock %}

{% block body %}
	<h1>TEST</h1>
	<div class="heading text-quaternary heading-border heading-bottom-border my-4 pb-2" style="margin-left:20px;">
		<h4 class="text-quaternary">
			<i class="fa-regular fa-id-card"></i>
			Registre de sécurité</h4>
	</div>
	<div class="row my-2 pb-2">
		{% if registres is null or registres is empty %}
			<div class="alert alert-info">
				<strong>
					<i class="fa-solid fa-microphone"></i>
					INFORMATION</strong>
				Registre vide pour le moment
			</div>
		{% else %}

			<div class="col-lg-12">

				<div class="card border-radius-1 bg-color-light border-2 box-shadow-1">
					<div class="card-body py-3 px-2">
						<div class="heading text-quaternary heading-border heading-bottom-border my-4 pb-2">
							<h4 class="text-quaternary">
								<i class="fa-solid fa-trailer"></i>
								Entrer du registre de sécurité</h4>
							<table class="table">

								<thead>
									<tr>

										<th>
											<i class="fa-solid fa-cube"></i>
											status</th>
										<th>
											<i class="fa-solid fa-calendar-days"></i>
											Type d'événement</th>
										<th>
											<i class="fa-solid fa-tag"></i>
											Intituler</th>

										<th>
											<i class="fa-solid fa-calendar-days"></i>
											Date de l'événement</th>

										<th>
											<i class="fa-solid fa-user-shield"></i>
											Agent</th>
										<th>
											<i class="fa-solid fa-user-shield"></i>
											Actions</th>
									</tr>
								</thead>
								<tbody>
									{% for registre in registres %}
										{% if registres is null or registres is empty %}

											<div class="alert alert-info">
												<strong>Registre</strong>
												Aucune entrée au registre pour le moment
											</div>
										{% else %}

											{% for status in registre.status %}
												{% if status.name == "En cours" %}
													<tr class="table-info" style="min-height: 200px;">
														<td>{{status.name}}</td>
													{% elseif status.name == "Intervention programmer" %}
														<tr class="table-info" style="min-height: 200px;">
															<td>{{status.name}}</td>
														{% elseif status.name == "Intervention terminer" %}
															<tr class="table-success" style="min-height: 200px;">
																<td>{{status.name}}</td>
															{% elseif status.name == "Attente de contrôlle" %}
																<tr class="table-warning" style="min-height: 200px;">
																	<td>{{status.name}}</td>
																{% elseif status.name == "Controller OK" %}
																	<tr class="table-secondary" style="min-height: 200px;">
																		<td>{{status.name}}</td>
																	{% elseif status.name == "Contrôle non valide" %}
																		<tr class="table-danger" style="min-height: 200px;">
																			<td>{{status.name}}</td>
																		{% elseif status.name == "Terminer" %}
																			<tr class="table-success" style="min-height: 200px;">
																				<td>{{status.name}}</td>
																			{% endif %}
																		{% endfor %}


																		<td>
																		<span class="badge badge-primary text-dark badge-md">
																			{# {{registre.categorie}} #}
																		</span>
																		</td>


																		<td>{{ registre.intituler}}</td>
																		<td>{{registre.createdAt|date('d-m-Y H:i')}}</td>
																		<td>{{registre.agent}}</td>
																		<td>
																			<div class="btn-group">
																				<button type="button" class="btn btn-danger dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
																					Action
																				</button>
																				<ul class="dropdown-menu">
																					<li>
																						<a class="dropdown-item" href="#">Voir</a>
																					</li>
																					<li>
																						<a class="dropdown-item" href="#">Terminé</a>
																					</li>
																					<li>
																						<a class="dropdown-item" href="#"></a>
																					</li>
																					<li><hr class="dropdown-divider"></li>
																					<li>
																						<a class="dropdown-item" href="#">Action irrversible</a>
																					</li>
																				</ul>
																			</div>
																		</td>
																	</tr>
																{% endif %}
															{% endfor %}
														</tbody>
													</tbody>
												</table>
												{{ knp_pagination_render(registres) }}
												<button class="btn btn-3d btn-warning mb-2 custombtn" data-bs-toggle="modal" data-bs-target="#formRem">
													<i class="fa-solid fa-plus"></i>
													AJOUTER
												</button>
											</div>
										</div>
									</div>
								</tbody>
							</div>

						{% endif %}
					{% endblock %}
